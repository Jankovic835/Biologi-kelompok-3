<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bio Tic-Tac-Toe üî¨</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #eef9f3;
            --board-bg: #ffffff;
            --primary-green: #2d6a4f;
            --secondary-green: #40916c;
            --text-dark: #1b4332;
            --x-color: #3a86ff;
            --o-color: #f77f00;
            --border-color: #d8f3dc;
        }

        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: var(--bg-color);
            color: var(--text-dark);
            text-align: center;
            padding: 15px;
        }

        .game-container {
            width: 100%;
            max-width: 500px;
            background-color: var(--board-bg);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        /* === Start Screen === */
        #start-screen h1 {
            color: var(--primary-green);
        }
        .mode-selection button {
            width: 80%;
            padding: 15px;
            margin: 10px 0;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            border: 2px solid var(--primary-green);
            background-color: transparent;
            color: var(--primary-green);
            border-radius: 12px;
            transition: all 0.3s ease;
        }
        .mode-selection button:hover {
            background-color: var(--primary-green);
            color: white;
        }
        .player-inputs input {
            width: 70%;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            font-family: inherit;
        }

        /* === Game Screen === */
        #game-screen {
            display: none;
        }

        #turn-display {
            font-size: 1.5em;
            font-weight: 600;
            color: var(--secondary-green);
            margin-bottom: 20px;
            min-height: 30px;
        }

        .board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 10px;
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
            aspect-ratio: 1 / 1;
        }

        .cell {
            background-color: var(--bg-color);
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3em;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .cell:hover:not(.x):not(.o) {
            background-color: #d8f3dc;
        }
        .cell.x { color: var(--x-color); }
        .cell.o { color: var(--o-color); }

        #game-status {
            margin-top: 20px;
            font-size: 1.2em;
            font-weight: 600;
            min-height: 30px;
            color: var(--primary-green);
        }

        .action-buttons button {
             padding: 10px 20px;
             margin: 5px;
             font-size: 1em;
             cursor: pointer;
             border: none;
             border-radius: 8px;
             background-color: var(--secondary-green);
             color: white;
             transition: background-color 0.2s;
        }
        .action-buttons button:hover {
            background-color: var(--primary-green);
        }

        /* === Quiz Modal === */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        .modal-overlay.visible {
            opacity: 1;
            pointer-events: auto;
        }

        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }
        .modal-overlay.visible .modal-content {
            transform: scale(1);
        }

        #question-text {
            font-size: 1.2em;
            margin-bottom: 20px;
        }
        
        .answer-options button {
            display: block;
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            background-color: transparent;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.2s ease;
        }
        .answer-options button:hover {
            background-color: var(--bg-color);
            border-color: var(--secondary-green);
        }
    </style>
</head>
<body>

<div class="game-container">
    <div id="start-screen">
        <h1>Bio Tic-Tac-Toe üî¨</h1>
        <p>Jawab pertanyaan biologi untuk menempatkan simbolmu!</p>
        <div class="player-inputs">
            <input type="text" id="p1-name" placeholder="Nama Player 1 (X)">
            <input type="text" id="p2-name" placeholder="Nama Player 2 (O)">
        </div>
        <div class="mode-selection">
            <button onclick="startGame('pvp')">üë®‚Äçüî¨ vs üë©‚Äçüî¨ Player vs Player</button>
            <button onclick="startGame('pvc')">üë®‚Äçüî¨ vs ü§ñ Player vs Computer</button>
        </div>
    </div>

    <div id="game-screen">
        <div id="turn-display">Giliran Player X</div>
        <div class="board">
            <div class="cell" data-index="0"></div>
            <div class="cell" data-index="1"></div>
            <div class="cell" data-index="2"></div>
            <div class="cell" data-index="3"></div>
            <div class="cell" data-index="4"></div>
            <div class="cell" data-index="5"></div>
            <div class="cell" data-index="6"></div>
            <div class="cell" data-index="7"></div>
            <div class="cell" data-index="8"></div>
        </div>
        <div id="game-status">Pilih kotak untuk memulai!</div>
        <div class="action-buttons">
            <button id="restart-btn">Ulangi Permainan</button>
            <button id="menu-btn">Kembali ke Menu</button>
        </div>
    </div>
</div>

<div class="modal-overlay" id="quiz-modal">
    <div class="modal-content">
        <div id="question-text">Ini adalah contoh pertanyaan.</div>
        <div class="answer-options">
            <button data-correct="false">Opsi A</button>
            <button data-correct="false">Opsi B</button>
            <button data-correct="false">Opsi C</button>
            <button data-correct="false">Opsi D</button>
        </div>
    </div>
</div>


<script>
    // === Data Pertanyaan ===
    const questions = [
        { q: "Apa sebutan untuk 'pabrik energi' di dalam sel?", a: ["Mitokondria", "Ribosom", "Nukleus", "Vakuola"], correct: "Mitokondria" },
        { q: "Proses di mana tumbuhan membuat makanannya sendiri disebut...", a: ["Respirasi", "Fotosintesis", "Transpirasi", "Gutasi"], correct: "Fotosintesis" },
        { q: "Manakah dari berikut ini yang merupakan pembawa sifat genetik?", a: ["RNA", "Protein", "Lipid", "DNA"], correct: "DNA" },
        { q: "Pembelahan sel yang menghasilkan sel gamet disebut...", a: ["Mitosis", "Meiosis", "Amitosis", "Fragmentasi"], correct: "Meiosis" },
        { q: "Lapisan terluar pada sel tumbuhan yang kaku disebut...", a: ["Membran Sel", "Dinding Sel", "Sitoplasma", "Kloroplas"], correct: "Dinding Sel" },
        { q: "Organisme yang dapat membuat makanannya sendiri disebut...", a: ["Heterotrof", "Autotrof", "Dekomposer", "Karnivora"], correct: "Autotrof" },
        { q: "Enzim amilase di mulut berfungsi untuk memecah...", a: ["Protein", "Lemak", "Vitamin", "Karbohidrat"], correct: "Karbohidrat" },
        { q: "Tulang terbesar di tubuh manusia adalah...", a: ["Tulang Kering", "Tulang Lengan", "Tulang Paha", "Tulang Rusuk"], correct: "Tulang Paha" },
    ];

    // === Variabel Game ===
    let boardState = ["", "", "", "", "", "", "", "", ""];
    let currentPlayer = "X";
    let isGameActive = true;
    let gameMode = 'pvp'; // 'pvp' or 'pvc'
    let playerNames = { X: "Player 1", O: "Player 2" };
    let currentCellIndex = null;

    const winningConditions = [
        [0, 1, 2], [3, 4, 5], [6, 7, 8], // Horizontal
        [0, 3, 6], [1, 4, 7], [2, 5, 8], // Vertikal
        [0, 4, 8], [2, 4, 6]  // Diagonal
    ];

    // === Elemen DOM ===
    const startScreen = document.getElementById('start-screen');
    const gameScreen = document.getElementById('game-screen');
    const cells = document.querySelectorAll('.cell');
    const turnDisplay = document.getElementById('turn-display');
    const gameStatus = document.getElementById('game-status');
    const quizModal = document.getElementById('quiz-modal');
    const questionText = document.getElementById('question-text');
    const answerButtons = document.querySelectorAll('.answer-options button');

    // === Fungsi Utama ===
    function startGame(mode) {
        gameMode = mode;
        const p1Name = document.getElementById('p1-name').value.trim();
        const p2Name = document.getElementById('p2-name').value.trim();

        playerNames.X = p1Name === '' ? 'Player 1' : p1Name;
        if (mode === 'pvc') {
            playerNames.O = 'Komputer';
        } else {
            playerNames.O = p2Name === '' ? 'Player 2' : p2Name;
        }

        startScreen.style.display = 'none';
        gameScreen.style.display = 'block';
        restartGame();
    }
    
    function handleCellClick(event) {
        const clickedCell = event.target;
        const clickedCellIndex = parseInt(clickedCell.getAttribute('data-index'));

        if (boardState[clickedCellIndex] !== "" || !isGameActive) {
            return;
        }
        
        currentCellIndex = clickedCellIndex;
        showQuiz();
    }

    function showQuiz() {
        const randomQuestion = questions[Math.floor(Math.random() * questions.length)];
        questionText.textContent = randomQuestion.q;
        
        // Acak urutan jawaban
        const shuffledAnswers = [...randomQuestion.a].sort(() => Math.random() - 0.5);

        answerButtons.forEach((button, index) => {
            button.textContent = shuffledAnswers[index];
            button.dataset.correct = shuffledAnswers[index] === randomQuestion.correct;
        });

        quizModal.classList.add('visible');
    }

    function handleAnswer(event) {
        const isCorrect = event.target.dataset.correct === 'true';
        quizModal.classList.remove('visible');

        if (isCorrect) {
            gameStatus.textContent = `Jawaban Benar! ${playerNames[currentPlayer]} menempatkan '${currentPlayer}'.`;
            placeMark(currentCellIndex);
        } else {
            gameStatus.textContent = `Jawaban Salah! Giliran ${playerNames[currentPlayer]} hangus.`;
            switchPlayer();
        }
    }
    
    function placeMark(index) {
        boardState[index] = currentPlayer;
        cells[index].textContent = currentPlayer;
        cells[index].classList.add(currentPlayer.toLowerCase());

        if (checkResult()) return;

        switchPlayer();
    }
    
    function switchPlayer() {
        currentPlayer = currentPlayer === "X" ? "O" : "X";
        turnDisplay.textContent = `Giliran ${playerNames[currentPlayer]} (${currentPlayer})`;

        if (gameMode === 'pvc' && currentPlayer === 'O' && isGameActive) {
            gameStatus.textContent = "Komputer sedang berpikir...";
            setTimeout(computerTurn, 1500);
        }
    }

    function checkResult() {
        let roundWon = false;
        for (let i = 0; i < winningConditions.length; i++) {
            const winCondition = winningConditions[i];
            const a = boardState[winCondition[0]];
            const b = boardState[winCondition[1]];
            const c = boardState[winCondition[2]];
            if (a === '' || b === '' || c === '') continue;
            if (a === b && b === c) {
                roundWon = true;
                break;
            }
        }

        if (roundWon) {
            gameStatus.textContent = `üèÜ Selamat! ${playerNames[currentPlayer]} menang!`;
            isGameActive = false;
            return true;
        }

        if (!boardState.includes("")) {
            gameStatus.textContent = "ü§ù Permainan Seri!";
            isGameActive = false;
            return true;
        }
        return false;
    }

    function restartGame() {
        boardState = ["", "", "", "", "", "", "", "", ""];
        isGameActive = true;
        currentPlayer = "X";
        cells.forEach(cell => {
            cell.textContent = "";
            cell.classList.remove('x', 'o');
        });
        turnDisplay.textContent = `Giliran ${playerNames[currentPlayer]} (${currentPlayer})`;
        gameStatus.textContent = "Pilih kotak untuk memulai!";
    }
    
    function backToMenu() {
        gameScreen.style.display = 'none';
        startScreen.style.display = 'block';
    }
    
    // === Logika AI Komputer ===
    function computerTurn() {
        // AI: Cari langkah untuk menang -> blok lawan -> ambil acak
        let move = findBestMove();

        if (move !== -1) {
            gameStatus.textContent = `Komputer menjawab benar dan menempatkan 'O'.`;
            placeMark(move);
        }
    }

    function findBestMove() {
        // 1. Cek jika komputer bisa menang
        for (let i = 0; i < boardState.length; i++) {
            if (boardState[i] === '') {
                boardState[i] = 'O';
                if (isWinning('O')) {
                    boardState[i] = ''; return i;
                }
                boardState[i] = '';
            }
        }
        // 2. Cek jika pemain akan menang (dan blok)
        for (let i = 0; i < boardState.length; i++) {
            if (boardState[i] === '') {
                boardState[i] = 'X';
                if (isWinning('X')) {
                    boardState[i] = ''; return i;
                }
                boardState[i] = '';
            }
        }
        // 3. Ambil kotak kosong secara acak
        let emptyCells = [];
        boardState.forEach((cell, index) => {
            if (cell === '') emptyCells.push(index);
        });
        if (emptyCells.length > 0) {
            return emptyCells[Math.floor(Math.random() * emptyCells.length)];
        }
        return -1; // Tidak ada gerakan
    }

    function isWinning(player) {
         for (const condition of winningConditions) {
            if (condition.every(index => boardState[index] === player)) {
                return true;
            }
        }
        return false;
    }


    // === Event Listeners ===
    cells.forEach(cell => cell.addEventListener('click', handleCellClick));
    answerButtons.forEach(button => button.addEventListener('click', handleAnswer));
    document.getElementById('restart-btn').addEventListener('click', restartGame);
    document.getElementById('menu-btn').addEventListener('click', backToMenu);

</script>
</body>
</html>
